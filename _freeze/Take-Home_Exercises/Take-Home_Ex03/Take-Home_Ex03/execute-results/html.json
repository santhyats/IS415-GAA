{
  "hash": "a4e298adbd93e85491f35620ae76d5a1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home 3\"\nauthor: \"Santhya Selvan\"\ndate: \"23 October 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n\nLoading in the packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(spdep, tmap, sf, ClustGeo, ggpubr, cluster, factoextra, NbClust, heatmaply, corrplot, psych, tidyverse, GGally)\n```\n:::\n\n\n\nLoading in the aspatial and spatial data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_district <- read_csv(\"data/aspatial/crime_district.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 19152 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): state, district, category, type\ndbl  (1): crimes\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\npopulation_district <- read_csv(\"data/aspatial/population_district.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 319200 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): state, district, sex, age, ethnicity\ndbl  (1): population\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nmsia_adm2_sf <- st_read(dsn = 'data/geosp', layer = 'mys_admbnda_adm2_unhcr_20210211')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mys_admbnda_adm2_unhcr_20210211' from data source \n  `C:\\santhyats\\IS415-GAA\\Take-Home_Exercises\\Take-Home_Ex03\\data\\geosp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 144 features and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 99.64072 ymin: 0.855001 xmax: 119.2697 ymax: 7.380556\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n\nformatting the crime data to only include the state names and their respective districts. Also filter out the rows where the data is aggregated. since population data is from 2016-2022, we will also remove the 2023 data rows.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_district <- crime_district %>% \n    filter(state != \"Malaysia\") %>% \n    filter(category == \"assault\") %>% \n    filter(district != \"All\") %>% \n    filter(type != \"all\") %>% \n    filter(date != \"2023-01-01\")\n```\n:::\n\n\n\nformatting the population data table to be simpler\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(lubridate)\n\n# population_state_filtered <- \npop_data <- population_district %>%\n    filter(year(ymd(date)) >= 2016 & year(ymd(date)) <= 2022) %>% \n    filter(sex == 'both') %>% \n    filter(age == 'overall') %>% \n    filter(ethnicity == 'overall') %>% \n    select(-c(3:5))\n```\n:::\n\n\n\nformatting the district boundary sf by dropping unnecessary columns\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadm2_sf <- msia_adm2_sf %>% select(-c(3:5, 8,9,11,12))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(adm2_sf) + tm_polygons()\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(pop_data$district)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"Batu Pahat\"             \"Johor Bahru\"            \"Kluang\"                \n  [4] \"Kota Tinggi\"            \"Kulai\"                  \"Mersing\"               \n  [7] \"Muar\"                   \"Pontian\"                \"Segamat\"               \n [10] \"Tangkak\"                \"Baling\"                 \"Bandar Baharu\"         \n [13] \"Kota Setar\"             \"Kuala Muda\"             \"Kubang Pasu\"           \n [16] \"Kulim\"                  \"Langkawi\"               \"Padang Terap\"          \n [19] \"Pendang\"                \"Pokok Sena\"             \"Sik\"                   \n [22] \"Yan\"                    \"Bachok\"                 \"Gua Musang\"            \n [25] \"Jeli\"                   \"Kecil Lojing\"           \"Kota Bharu\"            \n [28] \"Kuala Krai\"             \"Machang\"                \"Pasir Mas\"             \n [31] \"Pasir Puteh\"            \"Tanah Merah\"            \"Tumpat\"                \n [34] \"Alor Gajah\"             \"Jasin\"                  \"Melaka Tengah\"         \n [37] \"Jelebu\"                 \"Jempol\"                 \"Kuala Pilah\"           \n [40] \"Port Dickson\"           \"Rembau\"                 \"Seremban\"              \n [43] \"Tampin\"                 \"Bentong\"                \"Bera\"                  \n [46] \"Cameron Highlands\"      \"Jerantut\"               \"Kuantan\"               \n [49] \"Lipis\"                  \"Maran\"                  \"Pekan\"                 \n [52] \"Raub\"                   \"Rompin\"                 \"Temerloh\"              \n [55] \"Bagan Datuk\"            \"Batang Padang\"          \"Hilir Perak\"           \n [58] \"Hulu Perak\"             \"Kampar\"                 \"Kerian\"                \n [61] \"Kinta\"                  \"Kuala Kangsar\"          \"Larut Dan Matang\"      \n [64] \"Manjung\"                \"Muallim\"                \"Perak Tengah\"          \n [67] \"Selama\"                 \"Perlis\"                 \"Barat Daya\"            \n [70] \"Seberang Perai Selatan\" \"Seberang Perai Tengah\"  \"Seberang Perai Utara\"  \n [73] \"Timur Laut\"             \"Beaufort\"               \"Beluran\"               \n [76] \"Kalabakan\"              \"Keningau\"               \"Kinabatangan\"          \n [79] \"Kota Belud\"             \"Kota Kinabalu\"          \"Kota Marudu\"           \n [82] \"Kuala Penyu\"            \"Kudat\"                  \"Kunak\"                 \n [85] \"Lahad Datu\"             \"Nabawan\"                \"Papar\"                 \n [88] \"Penampang\"              \"Pitas\"                  \"Putatan\"               \n [91] \"Ranau\"                  \"Sandakan\"               \"Semporna\"              \n [94] \"Sipitang\"               \"Tambunan\"               \"Tawau\"                 \n [97] \"Telupid\"                \"Tenom\"                  \"Tongod\"                \n[100] \"Tuaran\"                 \"Asajaya\"                \"Bau\"                   \n[103] \"Belaga\"                 \"Beluru\"                 \"Betong\"                \n[106] \"Bintulu\"                \"Bukit Mabong\"           \"Dalat\"                 \n[109] \"Daro\"                   \"Julau\"                  \"Kabong\"                \n[112] \"Kanowit\"                \"Kapit\"                  \"Kuching\"               \n[115] \"Lawas\"                  \"Limbang\"                \"Lubok Antu\"            \n[118] \"Lundu\"                  \"Maradong\"               \"Marudi\"                \n[121] \"Matu\"                   \"Miri\"                   \"Mukah\"                 \n[124] \"Pakan\"                  \"Pusa\"                   \"Samarahan\"             \n[127] \"Saratok\"                \"Sarikei\"                \"Sebauh\"                \n[130] \"Selangau\"               \"Serian\"                 \"Sibu\"                  \n[133] \"Simunjan\"               \"Song\"                   \"Sri Aman\"              \n[136] \"Subis\"                  \"Tanjung Manis\"          \"Tatau\"                 \n[139] \"Tebedu\"                 \"Telang Usan\"            \"Gombak\"                \n[142] \"Klang\"                  \"Kuala Langat\"           \"Kuala Selangor\"        \n[145] \"Petaling\"               \"Sabak Bernam\"           \"Sepang\"                \n[148] \"Ulu Langat\"             \"Ulu Selangor\"           \"Besut\"                 \n[151] \"Dungun\"                 \"Hulu Terengganu\"        \"Kemaman\"               \n[154] \"Kuala Nerus\"            \"Kuala Terengganu\"       \"Marang\"                \n[157] \"Setiu\"                  \"W.P. Kuala Lumpur\"      \"W.P. Labuan\"           \n[160] \"W.P. Putrajaya\"         \"Cameron Highland\"       \"Sp Selatan\"            \n[163] \"Sp Tengah\"              \"Sp Utara\"              \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(adm2_sf$ADM2_EN)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"Batu Pahat\"        \"Johor Bahru\"       \"Kluang\"           \n  [4] \"Kota Tinggi\"       \"Kulaijaya\"         \"Ledang\"           \n  [7] \"Mersing\"           \"Muar\"              \"Pontian\"          \n [10] \"Segamat\"           \"Baling\"            \"Bandar Baharu\"    \n [13] \"Kota Setar\"        \"Kuala Muda\"        \"Kubang Pasu\"      \n [16] \"Kulim\"             \"Langkawi\"          \"Padang Terap\"     \n [19] \"Pendang\"           \"Pokok Sena\"        \"Sik\"              \n [22] \"Yan\"               \"Bachok\"            \"Gua Musang\"       \n [25] \"Jeli\"              \"Kota Bharu\"        \"Kuala Krai\"       \n [28] \"Machang\"           \"Pasir Mas\"         \"Pasir Puteh\"      \n [31] \"Tanah Merah\"       \"Tumpat\"            \"WP. Kuala Lumpur\" \n [34] \"W.P. Labuan\"       \"Alor Gajah\"        \"Jasin\"            \n [37] \"Melaka Tengah\"     \"Jelebu\"            \"Jempol\"           \n [40] \"Kuala Pilah\"       \"Port Dickson\"      \"Rembau\"           \n [43] \"Seremban\"          \"Tampin\"            \"Bentong\"          \n [46] \"Bera\"              \"Cameron Highlands\" \"Jerantut\"         \n [49] \"Kuantan\"           \"Lipis\"             \"Maran\"            \n [52] \"Pekan\"             \"Raub\"              \"Rompin\"           \n [55] \"Temerloh\"          \"Batang Padang\"     \"Hilir Perak\"      \n [58] \"Ulu Perak\"         \"Kampar\"            \"Kerian\"           \n [61] \"Kinta\"             \"Kuala Kangsar\"     \"Larut Dan Matang\" \n [64] \"Manjung (Dinding)\" \"Perak Tengah\"      \"Perlis\"           \n [67] \"Barat Daya\"        \"S.P.Selatan\"       \"S.P. Tengah\"      \n [70] \"S.P. Utara\"        \"Timur Laut\"        \"Beaufort\"         \n [73] \"Beluran\"           \"Keningau\"          \"Kinabatangan\"     \n [76] \"Kota Belud\"        \"Kota Kinabalu\"     \"Kota Marudu\"      \n [79] \"Kuala Penyu\"       \"Kudat\"             \"Kunak\"            \n [82] \"Lahad Datu\"        \"Nabawan\"           \"Papar\"            \n [85] \"Penampang\"         \"Pitas\"             \"Putatan\"          \n [88] \"Ranau\"             \"Sandakan\"          \"Semporna\"         \n [91] \"Sipitang\"          \"Tambunan\"          \"Tawau\"            \n [94] \"Tenom\"             \"Tongod\"            \"Tuaran\"           \n [97] \"Asajaya\"           \"Bau\"               \"Belaga\"           \n[100] \"Betong\"            \"Bintulu\"           \"Dalat\"            \n[103] \"Daro\"              \"Julau\"             \"Kanowit\"          \n[106] \"Kapit\"             \"Kuching\"           \"Lawas\"            \n[109] \"Limbang\"           \"Lubok Antu\"        \"Lundu\"            \n[112] \"Marudi\"            \"Matu\"              \"Meradong\"         \n[115] \"Miri\"              \"Mukah\"             \"Pakan\"            \n[118] \"Samarahan\"         \"Saratok\"           \"Sarikei\"          \n[121] \"Selangau\"          \"Serian\"            \"Sibu\"             \n[124] \"Simunjan\"          \"Song\"              \"Sri Aman\"         \n[127] \"Tatau\"             \"Besut\"             \"Dungun\"           \n[130] \"Hulu Terengganu\"   \"Kemaman\"           \"Kuala Terengganu\" \n[133] \"Marang\"            \"Setiu\"             \"W.P. Putrajaya\"   \n[136] \"Gombak\"            \"Ulu Langat\"        \"Ulu Selangor\"     \n[139] \"Klang\"             \"Kuala Langat\"      \"Kuala Selangor\"   \n[142] \"Petaling\"          \"Sabak Bernam\"      \"Sepang\"           \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(crime_district$district)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"Batu Pahat\"             \"Iskandar Puteri\"        \"Johor Bahru Selatan\"   \n  [4] \"Johor Bahru Utara\"      \"Kluang\"                 \"Kota Tinggi\"           \n  [7] \"Kulaijaya\"              \"Ledang\"                 \"Mersing\"               \n [10] \"Muar\"                   \"Nusajaya\"               \"Pontian\"               \n [13] \"Segamat\"                \"Seri Alam\"              \"Baling\"                \n [16] \"Bandar Baharu\"          \"Bandar Bharu\"           \"Kota Setar\"            \n [19] \"Kuala Muda\"             \"Kubang Pasu\"            \"Kulim\"                 \n [22] \"Langkawi\"               \"Padang Terap\"           \"Pendang\"               \n [25] \"Sik\"                    \"Yan\"                    \"Bachok\"                \n [28] \"Gua Musang\"             \"Jeli\"                   \"Kota Bharu\"            \n [31] \"Kuala Krai\"             \"Machang\"                \"Pasir Mas\"             \n [34] \"Pasir Puteh\"            \"Tanah Merah\"            \"Tumpat\"                \n [37] \"Alor Gajah\"             \"Jasin\"                  \"Melaka Tengah\"         \n [40] \"Jelebu\"                 \"Jempol\"                 \"Kuala Pilah\"           \n [43] \"Nilai\"                  \"Port Dickson\"           \"Rembau\"                \n [46] \"Seremban\"               \"Tampin\"                 \"Bentong\"               \n [49] \"Bera\"                   \"Cameron Highland\"       \"Cameron Highlands\"     \n [52] \"Jerantut\"               \"Kuala Lipis\"            \"Kuantan\"               \n [55] \"Maran\"                  \"Pekan\"                  \"Raub\"                  \n [58] \"Rompin\"                 \"Temerloh\"               \"Batu Gajah\"            \n [61] \"Gerik\"                  \"Hilir Perak\"            \"Ipoh\"                  \n [64] \"Kampar\"                 \"Kerian\"                 \"Kuala Kangsar\"         \n [67] \"Manjung\"                \"Pengkalan Hulu\"         \"Perak Tengah\"          \n [70] \"Selama\"                 \"Sungai Siput\"           \"Taiping\"               \n [73] \"Tanjong Malim\"          \"Tapah\"                  \"Arau\"                  \n [76] \"Kangar\"                 \"Padang Besar\"           \"Barat Daya\"            \n [79] \"Seberang Perai Selatan\" \"Seberang Perai Tengah\"  \"Seberang Perai Utara\"  \n [82] \"Timur Laut\"             \"Beaufort\"               \"Beluran\"               \n [85] \"Keningau\"               \"Kota Belud\"             \"Kota Kinabalu\"         \n [88] \"Kota Kinabatangan\"      \"Kota Marudu\"            \"Kudat\"                 \n [91] \"Kunak\"                  \"Lahad Datu\"             \"Papar\"                 \n [94] \"Penampang\"              \"Ranau\"                  \"Sandakan\"              \n [97] \"Semporna\"               \"Sipitang\"               \"Tawau\"                 \n[100] \"Tenom\"                  \"Tuaran\"                 \"W.P. Labuan\"           \n[103] \"Bau\"                    \"Belaga\"                 \"Betong\"                \n[106] \"Bintulu\"                \"Dalat\"                  \"Julau\"                 \n[109] \"Kanowit\"                \"Kapit\"                  \"Kota Samarahan\"        \n[112] \"Kuching\"                \"Lawas\"                  \"Limbang\"               \n[115] \"Lubok Antu\"             \"Lundu\"                  \"Marudi\"                \n[118] \"Matu Daro\"              \"Meradong\"               \"Miri\"                  \n[121] \"Mukah\"                  \"Padawan\"                \"Saratok\"               \n[124] \"Sarikei\"                \"Serian\"                 \"Sibu\"                  \n[127] \"Simunjan\"               \"Song\"                   \"Sri Aman\"              \n[130] \"Tatau\"                  \"Ampang Jaya\"            \"Gombak\"                \n[133] \"Hulu Selangor\"          \"Kajang\"                 \"Klang Selatan\"         \n[136] \"Klang Utara\"            \"Kuala Langat\"           \"Kuala Selangor\"        \n[139] \"Petaling Jaya\"          \"Sabak Bernam\"           \"Sepang\"                \n[142] \"Serdang\"                \"Sg. Buloh\"              \"Shah Alam\"             \n[145] \"Subang Jaya\"            \"Sungai Buloh\"           \"Besut\"                 \n[148] \"Dungun\"                 \"Hulu Terengganu\"        \"Kemaman\"               \n[151] \"Kuala Terengganu\"       \"Marang\"                 \"Setiu\"                 \n[154] \"Brickfields\"            \"Cheras\"                 \"Dang Wangi\"            \n[157] \"Sentul\"                 \"W.P. Putrajaya\"         \"Wangsa Maju\"           \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(pop_data, \"data/rds/pop_data.rds\")\nwrite_rds(crime_district, \"data/rds/crime_district.rds\")\nwrite_rds(adm2_sf, \"data/rds/adm2_sf.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_district$district <- tolower(trimws(crime_district$district))\nadm2_sf$ADM2_EN <- tolower(trimws(adm2_sf$ADM2_EN))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_sf<- left_join(crime_district, adm2_sf, by= c(\"district\" = \"ADM2_EN\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_sf_na<- new_sf[rowSums(is.na(new_sf)) > 0,]\n```\n:::\n",
    "supporting": [
      "Take-Home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}